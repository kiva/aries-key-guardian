import { Entity, PrimaryGeneratedColumn, Column } from 'typeorm';

@Entity()
export class SmsOtp {

    /**
     * For simplicity we have an autogenerated integer id
     */
    @PrimaryGeneratedColumn()
    id: number;

    /**
     * The agent id of the entity this record hold the phone number for
     */
    @Column({ length: 32, unique: true })
    agent_id: string;

    /**
     * First 32 bytes of SHA256 hash of government id 1 + pepper (aka national id)
     */
    @Column({ length: 32, unique: true })
    gov_id_1_hash: string;

    /**
     * First 32 bytes of SHA256 hash of government id 2 + pepper (aka voter id)
     */
    @Column({ length: 32, unique: true })
    gov_id_2_hash: string;

    /**
     * First 32 bytes of SHA256 hash of phone number
     */
    @Column({ length: 32, nullable: true })
    phone_number_hash: string;

    /**
     * 6-digit OTP
     */
    @Column({ nullable: true })
    otp: number;

    /**
     * Time when OTP is no longer valid
     */
    @Column({ type: 'timestamp without time zone', nullable: true })
    otp_expiration_time: Date;
}
